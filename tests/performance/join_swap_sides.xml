<test>
    <settings>
        <allow_experimental_statistic>1</allow_experimental_statistic>
        <join_algorithm>hash</join_algorithm>
    </settings>

    <create_query>CREATE TABLE large ( a String, b Int32 ) SETTINGS auto_statistics_types = 'uniq,minmax'</create_query>
    <create_query>CREATE TABLE small ( a String ) SETTINGS auto_statistics_types = 'uniq,minmax'</create_query>

    <fill_query>INSERT INTO large SELECT randomPrintableASCII(10), randUniform(1, 10000) FROM numbers(100000000)</fill_query>
    <fill_query>INSERT INTO small SELECT a FROM large ORDER BY rand() LIMIT 10000000</fill_query>

    <query><![CDATA[ SELECT count(*) FROM large l LEFT ANTI JOIN small s ON l.a = s.a WHERE b < 10 ]]></query>
    <query><![CDATA[ SELECT count(*) FROM small s RIGHT ANTI JOIN large l ON l.a = s.a WHERE b < 10 ]]></query>

    <query><![CDATA[ SELECT count(*) FROM large l LEFT SEMI JOIN small s ON l.a = s.a WHERE b < 10 ]]></query>
    <query><![CDATA[ SELECT count(*) FROM small s RIGHT SEMI JOIN large l ON l.a = s.a WHERE b < 10 ]]></query>

    <query><![CDATA[ SELECT count(*) FROM small s FULL OUTER JOIN large l ON l.a = s.a ]]></query>
    <query><![CDATA[ SELECT count(*) FROM large l FULL OUTER JOIN small s ON l.a = s.a]]></query>

    <query><![CDATA[ SELECT count(*) FROM small s FULL OUTER JOIN large l ON l.a = s.a SETTINGS join_use_nulls = 1 ]]></query>
    <query><![CDATA[ SELECT count(*) FROM large l FULL OUTER JOIN small s ON l.a = s.a SETTINGS join_use_nulls = 1 ]]></query>

    <drop_query>DROP TABLE large</drop_query>
    <drop_query>DROP TABLE small</drop_query>
</test>
